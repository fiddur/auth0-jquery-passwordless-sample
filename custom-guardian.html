<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <script src="http://code.jquery.com/jquery-2.1.1.min.js"></script>

    <script src="//use.typekit.net/iws6ohy.js"></script>
    <script>try{Typekit.load();}catch(e){}</script>

    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- font awesome from BootstrapCDN -->
    <link href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css" rel="stylesheet">
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">

    <script src="auth0-variables.js"> </script>
    <link href="app.css" rel="stylesheet">
  </head>
  <body class="home">
    <div class="container">
      <div class="login-page clearfix">
        <div class="login-box auth0-box before">
          <img class="logo" src="https://i.cloudup.com/StzWWrY34s.png" />
          <h3>Auth0 Passwordless Guardian Example</h3>
          <p>Login with Guardian</p>
          <form onsubmit="return login()">
            <div class="enter-username">
              <label>Enter your username: </label>
              <input id="username" class="username"/>
              <br><br>
              <button onclick="login()" class="btn btn-primary">Login with Guardian</button>
            </div>
          </form>
        </div>
        <div class="logged-in-box auth0-box logged-in" style="display: none;">
          <h1 id="logo"><img src="auth0_logo_final_blue_RGB.png" /></h1>
          <img class="avatar"/>
          <h2>Welcome <span class="nickname"></span></h2>
        </div>
      </div>
    </div>

    <!-- FIXME: Don't use development cdn on merge of this! -->
    <script src="https://cdn.auth0.com/js/auth0/development/auth0.min.js"></script>
    <script type="text/javascript">
     const webauth = new auth0.WebAuth({
       clientID:     AUTH0_CLIENT_ID,
       domain:       AUTH0_DOMAIN,
       redirectUri:  window.location.toString(),
       responseType: 'token'
     });

     const result = webauth.parseHash(window.location.hash);
     if (result && result.accessToken) {
       webauth.client.userInfo(
         result.accessToken,
         (err, result) => {
           $('.container').html(
             '<h1>Logged in!</h1><pre style="text-align: left">'
             + JSON.stringify(result, null, '  ') + '</pre>'
           )
         }
       );
     } else if (result && result.error) {
       alert('error: ' + result.error);
     }

     function login(){
       var username = $('input.username').val();

       webauth.login({
         connection: 'guardian',
         login_hint: username
       })
       return false;
     }

     document.getElementById('username').focus();
    </script>
  </body>
</html>
